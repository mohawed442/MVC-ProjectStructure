<div align="center">

# ğŸ”‘ Login System - Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø´Ø§Ù…Ù„

### *Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ù…ØªÙ‚Ø¯Ù… Ù…Ø¹ OTP ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠ*

<img src="https://cdn-icons-png.flaticon.com/512/6357/6357048.png" width="200" alt="Login System" />

[![Branch](https://img.shields.io/badge/Branch-login-blue?style=for-the-badge)](https://github.com/your-repo/tree/login)
[![Status](https://img.shields.io/badge/Status-Production_Ready-success?style=for-the-badge)](https://github.com/your-repo)
[![Version](https://img.shields.io/badge/Version-2.0.0-orange?style=for-the-badge)](https://github.com/your-repo)

</div>

---

## ğŸ“– Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª

- [Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©](#-Ù†Ø¸Ø±Ø©-Ø¹Ø§Ù…Ø©)
- [Ù‡ÙŠÙƒÙ„ÙŠØ© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„ÙƒØ§Ù…Ù„Ø©](#-Ù‡ÙŠÙƒÙ„ÙŠØ©-Ø§Ù„Ù…Ø´Ø±ÙˆØ¹-Ø§Ù„ÙƒØ§Ù…Ù„Ø©)
- [Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø´Ø±Ø­](#-Ø§Ù„ÙƒÙˆØ¯-Ø§Ù„ÙƒØ§Ù…Ù„-Ù…Ø¹-Ø§Ù„Ø´Ø±Ø­)
- [Ø¢Ù„ÙŠØ© Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©](#-Ø¢Ù„ÙŠØ©-Ø§Ù„Ø¹Ù…Ù„-Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©)
- [Ø¯Ù„ÙŠÙ„ Git Ø§Ù„Ù…ÙØµÙ„](#-Ø¯Ù„ÙŠÙ„-git-Ø§Ù„Ù…ÙØµÙ„)
- [Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©](#-Ø§Ù„Ù…Ù„ÙØ§Øª-Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©)
- [Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…](#-Ø§Ø®ØªØ¨Ø§Ø±-Ø§Ù„Ù†Ø¸Ø§Ù…)
- [Ø­Ù„ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„](#-Ø­Ù„-Ø§Ù„Ù…Ø´Ø§ÙƒÙ„)

---

## ğŸ¯ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

<div align="center">
<img src="https://user-images.githubusercontent.com/74038190/235224431-e8c8c12e-6826-47f1-89fb-2ddad83b3abf.gif" width="300" alt="Secure Login">
</div>

### **Ù†Ø¸Ø§Ù… Login Ù…ØªÙ‚Ø¯Ù… ÙŠØªØ¶Ù…Ù†:**

âœ… **ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù†** - Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±  
âœ… **OTP System** - Ø±Ù…Ø² ØªØ­Ù‚Ù‚ ÙŠØ±Ø³Ù„ Ø¹Ù†Ø¯ ÙƒÙ„ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„  
âœ… **Email Verification Check** - Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ù‚Ø¨Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„  
âœ… **Event-Driven** - Ù†Ø¸Ø§Ù… Events Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯  
âœ… **BCrypt Validation** - Ù…Ù‚Ø§Ø±Ù†Ø© Ø¢Ù…Ù†Ø© Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±  
âœ… **Error Handling** - Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù„Ù„Ø£Ø®Ø·Ø§Ø¡  
âœ… **JWT OTP Token** - Token Ù…Ø¤Ù‚Øª Ù„Ù„ØªØ­Ù‚Ù‚  
âœ… **Secure Cookies** - Ø­ÙØ¸ Ø¢Ù…Ù† Ù„Ù„Ù€ Tokens  
âœ… **Two-Factor Authentication Ready** - Ø¬Ø§Ù‡Ø² Ù„Ù„Ù€ 2FA

---

## ğŸ“ Ù‡ÙŠÙƒÙ„ÙŠØ© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„ÙƒØ§Ù…Ù„Ø©

<div align="center">
<img src="https://user-images.githubusercontent.com/74038190/212257454-16e3712e-945a-4ca2-b238-408ad0bf87e6.gif" width="80" alt="Project Structure">
</div>

```
ğŸ“¦ E-commerce-auth/
â”ƒ
â”£ ğŸ“‚ src/
â”ƒ â”ƒ
â”ƒ â”£ ğŸ“‚ controllers/
â”ƒ â”ƒ â”— ğŸ“œ auth.controller.js        â­ Ø§Ù„ÙƒÙ†ØªØ±ÙˆÙ„Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (login)
â”ƒ â”ƒ
â”ƒ â”£ ğŸ“‚ routes/
â”ƒ â”ƒ â”— ğŸ“œ auth.routes.js            ğŸ›£ï¸ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª
â”ƒ â”ƒ
â”ƒ â”£ ğŸ“‚ models/
â”ƒ â”ƒ â”£ ğŸ“œ user.model.js              ğŸ‘¤ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
â”ƒ â”ƒ â”— ğŸ“œ OTP.model.js               ğŸ” Ù†Ù…ÙˆØ°Ø¬ OTP
â”ƒ â”ƒ
â”ƒ â”£ ğŸ“‚ middlewares/
â”ƒ â”ƒ â”— ğŸ“œ validate.middleware.js    âœ”ï¸ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
â”ƒ â”ƒ
â”ƒ â”£ ğŸ“‚ validators/
â”ƒ â”ƒ â”— ğŸ“œ auth.validator.js         ğŸ“‹ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚
â”ƒ â”ƒ
â”ƒ â”£ ğŸ“‚ utils/
â”ƒ â”ƒ â”£ ğŸ“œ api-error.js               âŒ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
â”ƒ â”ƒ â”£ ğŸ“œ api-response.js            âœ… ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø§Øª
â”ƒ â”ƒ â”£ ğŸ“œ generate-code.js           ğŸ”¢ ØªÙˆÙ„ÙŠØ¯ OTP
â”ƒ â”ƒ â”£ ğŸ“œ email-event.js             ğŸ“§ Ù†Ø¸Ø§Ù… Events Ù„Ù„Ø¨Ø±ÙŠØ¯
â”ƒ â”ƒ â”— ğŸ“œ jwt.js                     ğŸ« Ø¥Ø¯Ø§Ø±Ø© JWT Tokens
â”ƒ â”ƒ
â”ƒ â”— ğŸ“œ app.js                        ğŸš€ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
â”ƒ
â”£ ğŸ“œ .env                             âš™ï¸ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦ÙŠØ©
â”£ ğŸ“œ package.json
â”— ğŸ“œ README.md
```

---

## ğŸ® Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø´Ø±Ø­

### **1ï¸âƒ£ Ø§Ù„Ù…Ø³Ø§Ø± (Route)** - `auth.routes.js`

<div align="center">
<img src="https://cdn-icons-png.flaticon.com/512/2920/2920277.png" width="80" alt="Routes">
</div>

```javascript
import express from "express";
import { validate } from "../middlewares/validate.middleware.js";
import { loginSchema } from "../validators/auth.validator.js";
import { login } from "../controllers/auth.controller.js";

const router = express.Router();

// ğŸ”‘ Ù…Ø³Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø¹ Validation Middleware
router.post("/login", validate(loginSchema, "body"), login);

export default router;
```

**ğŸ“Œ Ø§Ù„Ø´Ø±Ø­:**
- `validate()` - Middleware Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙƒÙ†ØªØ±ÙˆÙ„Ø±
- `loginSchema` - Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚ (email + password)
- `"body"` - Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† `req.body`

---

### **2ï¸âƒ£ Ø§Ù„ÙƒÙ†ØªØ±ÙˆÙ„Ø± (Controller)** - `auth.controller.js`

<div align="center">
<img src="https://cdn-icons-png.flaticon.com/512/2920/2920235.png" width="80" alt="Controller">
</div>

```javascript
import bcrypt from "bcryptjs";
import { emailEvent } from "../utils/email-event.js";
import ApiError from "../utils/api-error.js";
import ApiResponse from "../utils/api-response.js";
import generateCode from "../utils/generate-code.js";
import { generateOTPToken } from "../utils/jwt.js";
import User from "../models/user.model.js";
import OTP from "../models/OTP.model.js";

export const login = async (req, res, next) => {
  // ========================================
  // ğŸ“¥ Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Request
  // ========================================
  const { email, password } = req.body;

  // ========================================
  // ğŸ” Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  // ========================================
  const user = await User.findOne({ email });

  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  if (!user) {
    // Ø¥Ø±Ø¬Ø§Ø¹ Ø®Ø·Ø£ 401 Unauthorized
    return next(new ApiError("in-valid login Data", 401));
  }

  // ========================================
  // ğŸ” Ø§Ù„Ø®Ø·ÙˆØ© 3: Ù…Ù‚Ø§Ø±Ù†Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
  // ========================================
  const match = await bcrypt.compare(password, user.password);

  // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©
  if (!match) {
    return next(new ApiError("in-valid login Data", 401));
  }

  // ========================================
  // ğŸ”¢ Ø§Ù„Ø®Ø·ÙˆØ© 4: ØªÙˆÙ„ÙŠØ¯ Ø±Ù…Ø² OTP Ø¬Ø¯ÙŠØ¯
  // ========================================
  const code = generateCode(); // Ù…Ø«Ø§Ù„: 846291 (6 Ø£Ø±Ù‚Ø§Ù…)
  
  // Ø­ÙØ¸ Ø§Ù„Ù€ OTP ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  await OTP.create({ 
    userId: user._id, 
    code 
  });

  // ========================================
  // ğŸ“§ Ø§Ù„Ø®Ø·ÙˆØ© 5: Ø¥Ø±Ø³Ø§Ù„ OTP Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
  // ========================================
  // Ø§Ø³ØªØ®Ø¯Ø§Ù… Event Emitter Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø¨Ø´ÙƒÙ„ ØºÙŠØ± Ù…ØªØ²Ø§Ù…Ù†
  emailEvent.emit("sendConfirmEmail", { email, code });

  // ========================================
  // âœ‰ï¸ Ø§Ù„Ø®Ø·ÙˆØ© 6: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
  // ========================================
  if (!user.isVerified) {
    // Ù…Ù†Ø¹ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¤ÙƒØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø±ÙŠØ¯Ù‡
    return next(
      new ApiError("user is not verified check your email", 403)
    );
  }

  // ========================================
  // ğŸ« Ø§Ù„Ø®Ø·ÙˆØ© 7: Ø¥Ù†Ø´Ø§Ø¡ OTP Token
  // ========================================
  const token = generateOTPToken(String(user._id));

  // ========================================
  // ğŸª Ø§Ù„Ø®Ø·ÙˆØ© 8: Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù€ Cookie
  // ========================================
  const cookieOptions = {
    httpOnly: true,     // Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù‡ Ù…Ù† JavaScript
    secure: true,       // ÙŠØ¹Ù…Ù„ ÙÙ‚Ø· Ø¹Ù„Ù‰ HTTPS
    sameSite: "Strict", // Ø­Ù…Ø§ÙŠØ© Ù…Ù† CSRF attacks
    maxAge: 5 * 60 * 1000, // 5 Ø¯Ù‚Ø§Ø¦Ù‚
  };

  // Ø­ÙØ¸ Ø§Ù„Ù€ Token ÙÙŠ Cookie
  res.cookie("OTP_verification_token", token, cookieOptions);

  // ========================================
  // âœ… Ø§Ù„Ø®Ø·ÙˆØ© 9: Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©
  // ========================================
  return res
    .status(200)
    .json(
      new ApiResponse({ 
        message: "please check your email", 
        success: true 
      })
    );
};
```

---

## ğŸ” Ø¢Ù„ÙŠØ© Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©

<div align="center">
<img src="https://cdn-icons-png.flaticon.com/512/2910/2910791.png" width="150" alt="Workflow">
</div>

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±                 â”‚
â”‚     â†“                                                    â”‚
â”‚  2. Frontend ÙŠØ±Ø³Ù„ POST Request Ù„Ù€ /login               â”‚
â”‚     â†“                                                    â”‚
â”‚  3. Express Router ÙŠØ³ØªÙ‚Ø¨Ù„ Ø§Ù„Ø·Ù„Ø¨                        â”‚
â”‚     â†“                                                    â”‚
â”‚  4. Validation Middleware ÙŠØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª           â”‚
â”‚     â”œâ”€âŒ Ø¥Ø°Ø§ ÙØ´Ù„ â†’ Error 400 Bad Request              â”‚
â”‚     â””â”€âœ… Ø¥Ø°Ø§ Ù†Ø¬Ø­ â†’ ÙŠÙ†ØªÙ‚Ù„ Ù„Ù„ÙƒÙ†ØªØ±ÙˆÙ„Ø±                   â”‚
â”‚     â†“                                                    â”‚
â”‚  5. Controller: Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„Ø¨Ø±ÙŠØ¯             â”‚
â”‚     â”œâ”€âŒ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ â†’ Error 401 Unauthorized           â”‚
â”‚     â””â”€âœ… Ù…ÙˆØ¬ÙˆØ¯ â†’ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©                             â”‚
â”‚     â†“                                                    â”‚
â”‚  6. Ù…Ù‚Ø§Ø±Ù†Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù€ BCrypt                       â”‚
â”‚     â”œâ”€âŒ Ø®Ø§Ø·Ø¦Ø© â†’ Error 401 Unauthorized               â”‚
â”‚     â””â”€âœ… ØµØ­ÙŠØ­Ø© â†’ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©                             â”‚
â”‚     â†“                                                    â”‚
â”‚  7. ØªÙˆÙ„ÙŠØ¯ Ø±Ù…Ø² OTP Ø¬Ø¯ÙŠØ¯ (6 Ø£Ø±Ù‚Ø§Ù…)                      â”‚
â”‚     â†“                                                    â”‚
â”‚  8. Ø­ÙØ¸ Ø§Ù„Ù€ OTP ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª                     â”‚
â”‚     â†“                                                    â”‚
â”‚  9. Event Emitter ÙŠØ±Ø³Ù„ OTP Ù„Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ         â”‚
â”‚     â†“                                                    â”‚
â”‚  10. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† isVerified                             â”‚
â”‚     â”œâ”€âŒ false â†’ Error 403 Forbidden                  â”‚
â”‚     â””â”€âœ… true â†’ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©                              â”‚
â”‚     â†“                                                    â”‚
â”‚  11. Ø¥Ù†Ø´Ø§Ø¡ OTP JWT Token                               â”‚
â”‚     â†“                                                    â”‚
â”‚  12. Ø­ÙØ¸ Ø§Ù„Ù€ Token ÙÙŠ Secure Cookie                    â”‚
â”‚     â†“                                                    â”‚
â”‚  13. Ø¥Ø±Ø¬Ø§Ø¹ Response 200 OK                             â”‚
â”‚     â†“                                                    â”‚
â”‚  14. Frontend ÙŠØ¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© "ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨Ø±ÙŠØ¯Ùƒ"              â”‚
â”‚     â†“                                                    â”‚
â”‚  15. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¯Ø®Ù„ OTP Ù…Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯                       â”‚
â”‚     â†“                                                    â”‚
â”‚  16. Backend ÙŠØªØ­Ù‚Ù‚ Ù…Ù† OTP â†’ ÙŠØµØ¯Ø± Access Token         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ†š Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Login Ùˆ Signup

<div align="center">
<img src="https://cdn-icons-png.flaticon.com/512/2920/2920277.png" width="100" alt="Comparison">
</div>

| Ø§Ù„Ø¹Ù†ØµØ± | ğŸ”‘ Login | ğŸ“ Signup |
|:---:|:---|:---|
| **Ø§Ù„Ù‡Ø¯Ù** | Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø­Ø³Ø§Ø¨ Ù…ÙˆØ¬ÙˆØ¯ | Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯ |
| **Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©** | email + password ÙÙ‚Ø· | name, email, password, phone, etc. |
| **Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©** | Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª | Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© |
| **Ø§Ù„ØªØ´ÙÙŠØ±** | Ù…Ù‚Ø§Ø±Ù†Ø© bcrypt.compare | ØªØ´ÙÙŠØ± bcrypt.hash |
| **Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯** | Ø§Ù„ØªØ£ÙƒØ¯ Ø£Ù†Ù‡ Ù…Ø¤ÙƒØ¯ (isVerified) | Ø¥Ø±Ø³Ø§Ù„ OTP Ù„Ù„ØªØ£ÙƒÙŠØ¯ |
| **OTP** | ÙŠØ±Ø³Ù„ Ø¹Ù†Ø¯ ÙƒÙ„ Ø¯Ø®ÙˆÙ„ | ÙŠØ±Ø³Ù„ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© Ù„Ù„ØªØ£ÙƒÙŠØ¯ |
| **Status Code** | 200 OK | 201 Created |
| **Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©** | 401 Unauthorized, 403 Forbidden | 409 Conflict |
| **Ø§Ù„Ù€ Token** | OTP Token Ù…Ø¤Ù‚Øª | OTP Token Ù…Ø¤Ù‚Øª |
| **Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©** | Ø¥Ø¯Ø®Ø§Ù„ OTP â†’ Access Token | ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¨Ø±ÙŠØ¯ â†’ Login |

---

## ğŸ› ï¸ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©

### **3ï¸âƒ£ User Model** - `user.model.js`

<div align="center">
<img src="https://cdn-icons-png.flaticon.com/512/1183/1183672.png" width="80" alt="User Model">
</div>

```javascript
import mongoose, { Schema, model } from "mongoose";

const userSchema = new Schema({
  userName: {
    type: String,
    required: [true, 'Username is required'],
    unique: true,
    minlength: 3,
    maxlength: 30,
    trim: true
  },
  fullName: {
    type: String,
    required: [true, 'Full name is required'],
    minlength: 3,
    maxlength: 50,
    trim: true
  },
  email: {
    type: String,
    required: [true, 'Email is required'],
    unique: true,
    lowercase: true,
    trim: true,
    match: [/^\S+@\S+\.\S+$/, 'Please use a valid email address']
  },
  password: {
    type: String,
    required: [true, 'Password is required'],
    minlength: 6
  },
  phoneNumber: {
    type: String,
    required: [true, 'Phone number is required'],
  },
  gender: {
    type: String,
    enum: ['male', 'female', 'other'],
    default: 'male'
  },
  bio: {
    type: String,
    maxlength: 500,
    default: ''
  },
  date_of_birth: {
    type: Date,
    required: false
  },
  isVerified: {
    type: Boolean,
    default: false  // â­ Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹ Ù„Ù€ Login
  },
  role: {
    type: String,
    enum: ['user', 'admin'],
    default: 'user'
  },
  profileImage: {
    type: String,
    default: null
  },
  lastLogin: {
    type: Date,
    default: null
  }
}, { 
  timestamps: true
});

const User = mongoose.models.User || model("User", userSchema);
export default User;
```

---

### **4ï¸âƒ£ OTP Model** - `OTP.model.js`

```javascript
import mongoose, { Schema, model } from "mongoose";

const otpSchema = new Schema({
  userId: {
    type: Schema.Types.ObjectId,
    ref: 'User',
    required: true
  },
  code: {
    type: String,
    required: true,
    length: 6
  },
  type: {
    type: String,
    enum: ['login', 'signup', 'reset-password'],
    default: 'login'  // â­ Ù†ÙˆØ¹ Ø§Ù„Ù€ OTP
  },
  attempts: {
    type: Number,
    default: 0,
    max: 3  // Ø­Ø¯ Ø£Ù‚ØµÙ‰ 3 Ù…Ø­Ø§ÙˆÙ„Ø§Øª
  },
  createdAt: {
    type: Date,
    default: Date.now,
    expires: 300 // ÙŠÙ†ØªÙ‡ÙŠ Ø¨Ø¹Ø¯ 5 Ø¯Ù‚Ø§Ø¦Ù‚
  }
});

// Index Ù„Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø±ÙŠØ¹
otpSchema.index({ userId: 1, type: 1, createdAt: -1 });

const OTP = mongoose.models.OTP || model("OTP", otpSchema);
export default OTP;
```

---

### **5ï¸âƒ£ Login Validator** - `auth.validator.js`

<div align="center">
<img src="https://cdn-icons-png.flaticon.com/512/2920/2920349.png" width="80" alt="Validation">
</div>

```javascript
import Joi from 'joi';

// Schema Ù„Ù„Ù€ Login
export const loginSchema = Joi.object({
  email: Joi.string()
    .email()
    .required()
    .messages({
      'string.email': 'Please enter a valid email address',
      'any.required': 'Email is required'
    }),

  password: Joi.string()
    .min(6)
    .required()
    .messages({
      'string.min': 'Password must be at least 6 characters',
      'any.required': 'Password is required'
    })
});

// Schema Ù„Ù„Ù€ OTP Verification
export const verifyOTPSchema = Joi.object({
  code: Joi.string()
    .length(6)
    .pattern(/^[0-9]+$/)
    .required()
    .messages({
      'string.length': 'OTP must be 6 digits',
      'string.pattern.base': 'OTP must contain only numbers',
      'any.required': 'OTP code is required'
    })
});
```

---

### **6ï¸âƒ£ Email Event System** - `email-event.js`

<div align="center">
<img src="https://cdn-icons-png.flaticon.com/512/732/732200.png" width="80" alt="Email">
</div>

```javascript
import { EventEmitter } from 'events';
import nodemailer from 'nodemailer';
import logger from './logger.js';

export const emailEvent = new EventEmitter();

const transporter = nodemailer.createTransporter({
  host: process.env.EMAIL_HOST,
  port: process.env.EMAIL_PORT,
  secure: process.env.EMAIL_PORT === '465',
  auth: {
    user: process.env.EMAIL_USER,
    pass: process.env.EMAIL_PASS
  }
});

/**
 * Event: Ø¥Ø±Ø³Ø§Ù„ OTP Ù„Ù„Ù€ Login
 */
emailEvent.on('sendConfirmEmail', async ({ email, code }) => {
  try {
    const mailOptions = {
      from: `"${process.env.APP_NAME}" <${process.env.EMAIL_USER}>`,
      to: email,
      subject: 'ğŸ” Ø±Ù…Ø² ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - Login OTP Code',
      html: `
        <!DOCTYPE html>
        <html dir="rtl" lang="ar">
        <head>
          <meta charset="UTF-8">
          <style>
            body {
              font-family: Arial, sans-serif;
              background-color: #f4f4f4;
              padding: 20px;
              direction: rtl;
            }
            .container {
              max-width: 600px;
              margin: 0 auto;
              background: white;
              padding: 40px;
              border-radius: 10px;
              box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            }
            .header {
              text-align: center;
              color: #2196F3;
              margin-bottom: 30px;
            }
            .code-box {
              background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
              border-radius: 10px;
              padding: 30px;
              text-align: center;
              margin: 30px 0;
            }
            .code {
              font-size: 42px;
              font-weight: bold;
              letter-spacing: 15px;
              color: white;
              text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            }
            .info {
              background: #f9f9f9;
              border-right: 4px solid #2196F3;
              padding: 15px;
              margin: 20px 0;
            }
            .footer {
              text-align: center;
              color: #666;
              font-size: 14px;
              margin-top: 30px;
              padding-top: 20px;
              border-top: 1px solid #eee;
            }
            .warning {
              background: #fff3cd;
              border-right: 4px solid #ffc107;
              padding: 15px;
              margin: 20px 0;
            }
          </style>
        </head>
        <body>
          <div class="container">
            <div class="header">
              <h1>ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù†</h1>
              <p>Ø·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø¬Ø¯ÙŠØ¯</p>
            </div>
            
            <p>Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ</p>
            <p>ØªÙ… Ø·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ù„Ø­Ø³Ø§Ø¨Ùƒ. Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø±Ù…Ø² Ø§Ù„ØªØ§Ù„ÙŠ Ù„Ø¥ÙƒÙ…Ø§Ù„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯Ø®ÙˆÙ„:</p>
            
            <div class="code-box">
              <div class="code">${code}</div>
            </div>
            
            <div class="info">
              <p><strong>â±ï¸ Ù…Ø¯Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©:</strong> Ù‡Ø°Ø§ Ø§Ù„Ø±Ù…Ø² ØµØ§Ù„Ø­ Ù„Ù…Ø¯Ø© 5 Ø¯Ù‚Ø§Ø¦Ù‚ ÙÙ‚Ø·</p>
              <p><strong>ğŸ”’ Ø§Ù„Ø£Ù…Ø§Ù†:</strong> Ù„Ø§ ØªØ´Ø§Ø±Ùƒ Ù‡Ø°Ø§ Ø§Ù„Ø±Ù…Ø² Ù…Ø¹ Ø£ÙŠ Ø´Ø®Øµ</p>
            </div>
            
            <div class="warning">
              <p><strong>âš ï¸ ØªØ­Ø°ÙŠØ± Ø£Ù…Ù†ÙŠ:</strong></p>
              <p>Ø¥Ø°Ø§ Ù„Ù… ØªÙ‚Ù… Ø¨Ø·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ ÙŠØ±Ø¬Ù‰ ØªØ¬Ø§Ù‡Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ ÙˆØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙÙˆØ±Ø§Ù‹.</p>
            </div>
            
            <div class="footer">
              <p>Â© 2024 ${process.env.APP_NAME}. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
              <p>Ù‡Ø°Ø§ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØŒ ÙŠØ±Ø¬Ù‰ Ø¹Ø¯Ù… Ø§Ù„Ø±Ø¯ Ø¹Ù„ÙŠÙ‡.</p>
            </div>
          </div>
        </body>
        </html>
      `
    };

    await transporter.sendMail(mailOptions);
    logger.info('Login OTP email sent successfully', { email });
    
  } catch (error) {
    logger.error('Failed to send login OTP email', { 
      email, 
      error: error.message 
    });
  }
});

// Event Ù„Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø¹Ù† Ù…Ø­Ø§ÙˆÙ„Ø© Ø¯Ø®ÙˆÙ„ Ù…Ø´Ø¨ÙˆÙ‡Ø©
emailEvent.on('sendLoginAlert', async ({ email, ip, device }) => {
  try {
    await transporter.sendMail({
      from: `"${process.env.APP_NAME} Security" <${process.env.EMAIL_USER}>`,
      to: email,
      subject: 'ğŸš¨ ØªÙ†Ø¨ÙŠÙ‡ Ø£Ù…Ù†ÙŠ: Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø¬Ø¯ÙŠØ¯Ø©',
      html: `
        <h1>ğŸš¨ ØªÙ†Ø¨ÙŠÙ‡ Ø£Ù…Ù†ÙŠ</h1>
        <p>ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¯Ø®ÙˆÙ„ Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø­Ø³Ø§Ø¨Ùƒ:</p>
        <ul>
          <li><strong>Ø¹Ù†ÙˆØ§Ù† IP:</strong> ${ip}</li>
          <li><strong>Ø§Ù„Ø¬Ù‡Ø§Ø²:</strong> ${device}</li>
          <li><strong>Ø§Ù„ÙˆÙ‚Øª:</strong> ${new Date().toLocaleString('ar-EG')}</li>
        </ul>
        <p>Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ø£Ù†Øª Ù…Ù† Ù‚Ø§Ù… Ø¨Ø°Ù„ÙƒØŒ ÙŠØ±Ø¬Ù‰ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙÙˆØ±Ø§Ù‹.</p>
      `
    });
    
    logger.info('Login alert sent', { email });
  } catch (error) {
    logger.error('Failed to send login alert', { email, error: error.message });
  }
});
```

---

## âš™ï¸ Environment Variables

<div align="center">
<img src="https://cdn-icons-png.flaticon.com/512/3588/3588315.png" width="100" alt="Environment">
</div>

```env
# ========================================
# ğŸ—„ï¸ MongoDB Configuration
# ========================================
MONGO_URI=mongodb+srv://username:password@cluster.mongodb.net/ecommerce

# ========================================
# ğŸ” Encryption & Hashing
# ========================================
SALT=10
ENCRYPT=your-crypto-secret-key-32chars

# ========================================
# ğŸ« JWT Secrets
# ========================================
JWT_OTP_SECRET=your-otp-secret-minimum-32-characters

# ========================================
# ğŸ“§ Email Configuration
# ========================================
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USER=your-email@gmail.com
EMAIL_PASS=your-app-password

# ========================================
# ğŸŒ Application Settings
# ========================================
APP_NAME=E-Commerce Platform
NODE_ENV=development
PORT=3000
```

---

## ğŸ”„ Ø¯Ù„ÙŠÙ„ Git Ø§Ù„Ù…ÙØµÙ„

<div align="center">
<img src="https://cdn-icons-png.flaticon.com/512/4494/4494740.png" width="100" alt="Git Guide">
</div>

### **ğŸ“‹ Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 1: Ø§Ø³ØªÙ†Ø³Ø§Ø® ÙˆØ§Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Login Branch**

```bash
# ========================================
# 1ï¸âƒ£ Ø§Ø³ØªÙ†Ø³Ø§Ø® Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
# ========================================
git clone https://github.com/your-username/e-commerce-auth.git
cd e-commerce-auth

# ========================================
# 2ï¸âƒ£ Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆØ¹
# ========================================
git fetch --all

# Ø¹Ø±Ø¶ Ø§Ù„ÙØ±ÙˆØ¹ Ø§Ù„Ù…ØªØ§Ø­Ø©
git branch -a
# Output:
# * main
#   remotes/origin/login
#   remotes/origin/signup

# ========================================
# 3ï¸âƒ£ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„ÙØ±Ø¹ Login
# ========================================
git checkout login

# Ø£Ùˆ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ù…Ø­Ù„ÙŠØ©
git checkout -b login origin/login

# ========================================
# 4ï¸âƒ£ ØªØ«Ø¨ÙŠØª Ø§Ù„Ø­Ø²Ù…
# ========================================
npm install

# ========================================
# 5ï¸âƒ£ Ø¥Ø¹Ø¯Ø§Ø¯ Environment
# ========================================
cp .env.example .env
# Ø¹Ø¯Ù„ .env Ø¨Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ

# ========================================
# 6ï¸âƒ£ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
# ========================================
npm run dev

# ÙŠØ¬Ø¨ Ø£Ù† ØªØ±Ù‰:
# âœ… Database Connected
# ğŸš€ Server running at: http://localhost:3000
```

---

### **ğŸ“‹ Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 2: Ø¯Ù…Ø¬ Login ÙÙŠ Dev**

```bash
# ========================================
# 1ï¸âƒ£ Ø¥Ù†Ø´Ø§Ø¡/Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„ÙØ±Ø¹ Dev
# ========================================
git checkout main
git checkout -b dev

# ========================================
# 2ï¸âƒ£ Ø¯Ù…Ø¬ Login Branch
# ========================================
git merge origin/login --no-ff -m "Merge login controller with OTP"

# Ø¥Ø°Ø§ Ø­Ø¯Ø«Øª conflicts:
# 1. Ø§ÙØªØ­ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…ØªØ¹Ø§Ø±Ø¶
# 2. Ø§Ø­ØªÙØ¸ Ø¨ÙƒÙ„Ø§ Ø§Ù„Ù€ Controllers (login + signup)
#
